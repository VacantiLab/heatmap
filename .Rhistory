source('~/Dropbox/Research/Lehtio_Laboratory/Tools/R Functions/Heatmap Functions/GetGroupLegend.R')
source('~/Dropbox/Research/Lehtio_Laboratory/Tools/R Functions/Heatmap Functions/MakeHeatmap.R')
MakeHeatMap(data=data,heatmap_directory = heatmap_directory,cluster_directory = cluster_directory,group_color_designations_file = group_color_designations_file,break_seq = seq(-2,2,0.5),ColGroupsScheme = c('Consensus Proteome','PAM50'),Scale_Rows = FALSE,TakeLog2 = TRUE,label_rows = FALSE,select_groups_to_keep = NULL)
source('~/Dropbox/Research/Lehtio_Laboratory/Tools/R Functions/Heatmap Functions/GetGroupLegend.R')
source('~/Dropbox/Research/Lehtio_Laboratory/Tools/R Functions/Heatmap Functions/GetGroupLegend.R')
source('~/Dropbox/Research/Lehtio_Laboratory/Tools/R Functions/Heatmap Functions/GetGroupLegend.R')
MakeHeatMap(data=data,heatmap_directory = heatmap_directory,cluster_directory = cluster_directory,group_color_designations_file = group_color_designations_file,break_seq = seq(-2,2,0.5),ColGroupsScheme = c('Consensus Proteome','PAM50'),Scale_Rows = FALSE,TakeLog2 = TRUE,label_rows = FALSE,select_groups_to_keep = NULL)
source('~/Dropbox/Research/Lehtio_Laboratory/Tools/R Functions/Heatmap Functions/GetGroupLegend.R')
MakeHeatMap(data=data,heatmap_directory = heatmap_directory,cluster_directory = cluster_directory,group_color_designations_file = group_color_designations_file,break_seq = seq(-2,2,0.5),ColGroupsScheme = c('Consensus Proteome','PAM50'),Scale_Rows = FALSE,TakeLog2 = TRUE,label_rows = FALSE,select_groups_to_keep = NULL)
source('~/Dropbox/Research/Lehtio_Laboratory/Tools/R Functions/Heatmap Functions/GetGroupLegend.R')
MakeHeatMap(data=data,heatmap_directory = heatmap_directory,cluster_directory = cluster_directory,group_color_designations_file = group_color_designations_file,break_seq = seq(-2,2,0.5),ColGroupsScheme = c('Consensus Proteome','PAM50'),Scale_Rows = FALSE,TakeLog2 = TRUE,label_rows = FALSE,select_groups_to_keep = NULL)
group_names
group_colors
source('~/Dropbox/Research/Lehtio_Laboratory/Tools/R Functions/Heatmap Functions/MakeHeatmap.R')
MakeHeatMap(data=data,heatmap_directory = heatmap_directory,cluster_directory = cluster_directory,group_color_designations_file = group_color_designations_file,break_seq = seq(-2,2,0.5),ColGroupsScheme = c('Consensus Proteome','PAM50'),Scale_Rows = FALSE,TakeLog2 = TRUE,label_rows = FALSE,select_groups_to_keep = NULL)
group_colors
source('~/Dropbox/Research/Lehtio_Laboratory/Tools/R Functions/Heatmap Functions/GetGroupLegend.R')
MakeHeatMap(data=data,heatmap_directory = heatmap_directory,cluster_directory = cluster_directory,group_color_designations_file = group_color_designations_file,break_seq = seq(-2,2,0.5),ColGroupsScheme = c('Consensus Proteome','PAM50'),Scale_Rows = FALSE,TakeLog2 = TRUE,label_rows = FALSE,select_groups_to_keep = NULL)
source('~/Dropbox/Research/Lehtio_Laboratory/Tools/R Functions/Heatmap Functions/GetGroupLegend.R')
source('~/Dropbox/Research/Lehtio_Laboratory/Tools/R Functions/Heatmap Functions/GetGroupLegend.R')
MakeHeatMap(data=data,heatmap_directory = heatmap_directory,cluster_directory = cluster_directory,group_color_designations_file = group_color_designations_file,break_seq = seq(-2,2,0.5),ColGroupsScheme = c('Consensus Proteome','PAM50'),Scale_Rows = FALSE,TakeLog2 = TRUE,label_rows = FALSE,select_groups_to_keep = NULL)
source('~/Dropbox/Research/Lehtio_Laboratory/Tools/R Functions/Heatmap Functions/MakeHeatmap.R')
source('~/Dropbox/Research/Lehtio_Laboratory/Tools/R Functions/Heatmap Functions/GetGroupLegend.R')
source('~/Dropbox/Research/Lehtio_Laboratory/Tools/R Functions/Heatmap Functions/GetGroupLegend.R')
MakeHeatMap(data=data,heatmap_directory = heatmap_directory,cluster_directory = cluster_directory,group_color_designations_file = group_color_designations_file,break_seq = seq(-2,2,0.5),ColGroupsScheme = c('Consensus Proteome','PAM50'),Scale_Rows = FALSE,TakeLog2 = TRUE,label_rows = FALSE,select_groups_to_keep = NULL)
source('~/Dropbox/Research/Lehtio_Laboratory/Tools/R Functions/Heatmap Functions/GetGroupLegend.R')
source('~/Dropbox/Research/Lehtio_Laboratory/Tools/R Functions/Heatmap Functions/GetGroupLegend.R')
MakeHeatMap(data=data,heatmap_directory = heatmap_directory,cluster_directory = cluster_directory,group_color_designations_file = group_color_designations_file,break_seq = seq(-2,2,0.5),ColGroupsScheme = c('Consensus Proteome','PAM50'),Scale_Rows = FALSE,TakeLog2 = TRUE,label_rows = FALSE,select_groups_to_keep = NULL)
source('~/Dropbox/Research/Lehtio_Laboratory/Tools/R Functions/Heatmap Functions/GetGroupLegend.R')
MakeHeatMap(data=data,heatmap_directory = heatmap_directory,cluster_directory = cluster_directory,group_color_designations_file = group_color_designations_file,break_seq = seq(-2,2,0.5),ColGroupsScheme = c('Consensus Proteome','PAM50'),Scale_Rows = FALSE,TakeLog2 = TRUE,label_rows = FALSE,select_groups_to_keep = NULL)
source('~/Dropbox/Research/Lehtio_Laboratory/Tools/R Functions/Heatmap Functions/GetGroupLegend.R')
MakeHeatMap(data=data,heatmap_directory = heatmap_directory,cluster_directory = cluster_directory,group_color_designations_file = group_color_designations_file,break_seq = seq(-2,2,0.5),ColGroupsScheme = c('Consensus Proteome','PAM50'),Scale_Rows = FALSE,TakeLog2 = TRUE,label_rows = FALSE,select_groups_to_keep = NULL)
source('~/Dropbox/Research/Lehtio_Laboratory/Tools/R Functions/Heatmap Functions/GetGroupLegend.R')
MakeHeatMap(data=data,heatmap_directory = heatmap_directory,cluster_directory = cluster_directory,group_color_designations_file = group_color_designations_file,break_seq = seq(-2,2,0.5),ColGroupsScheme = c('Consensus Proteome','PAM50'),Scale_Rows = FALSE,TakeLog2 = TRUE,label_rows = FALSE,select_groups_to_keep = NULL)
source('~/Dropbox/Research/Lehtio_Laboratory/Tools/R Functions/Heatmap Functions/GetGroupLegend.R')
MakeHeatMap(data=data,heatmap_directory = heatmap_directory,cluster_directory = cluster_directory,group_color_designations_file = group_color_designations_file,break_seq = seq(-2,2,0.5),ColGroupsScheme = c('Consensus Proteome','PAM50'),Scale_Rows = FALSE,TakeLog2 = TRUE,label_rows = FALSE,select_groups_to_keep = NULL)
source('~/Dropbox/Research/Lehtio_Laboratory/Tools/R Functions/Heatmap Functions/GetGroupLegend.R')
MakeHeatMap(data=data,heatmap_directory = heatmap_directory,cluster_directory = cluster_directory,group_color_designations_file = group_color_designations_file,break_seq = seq(-2,2,0.5),ColGroupsScheme = c('Consensus Proteome','PAM50'),Scale_Rows = FALSE,TakeLog2 = TRUE,label_rows = FALSE,select_groups_to_keep = NULL)
source('~/Dropbox/Research/Lehtio_Laboratory/Tools/R Functions/Heatmap Functions/GetGroupLegend.R')
MakeHeatMap(data=data,heatmap_directory = heatmap_directory,cluster_directory = cluster_directory,group_color_designations_file = group_color_designations_file,break_seq = seq(-2,2,0.5),ColGroupsScheme = c('Consensus Proteome','PAM50'),Scale_Rows = FALSE,TakeLog2 = TRUE,label_rows = FALSE,select_groups_to_keep = NULL)
source('~/Dropbox/Research/Lehtio_Laboratory/Tools/R Functions/Heatmap Functions/GetGroupLegend.R')
MakeHeatMap(data=data,heatmap_directory = heatmap_directory,cluster_directory = cluster_directory,group_color_designations_file = group_color_designations_file,break_seq = seq(-2,2,0.5),ColGroupsScheme = c('Consensus Proteome','PAM50'),Scale_Rows = FALSE,TakeLog2 = TRUE,label_rows = FALSE,select_groups_to_keep = NULL)
sort(c(1,2,3,4))
sort(c(1,0.5,3,4))
order(c(3,2,5,6))
source('~/Dropbox/Research/Lehtio_Laboratory/Tools/R Functions/Heatmap Functions/GetGroupLegend.R')
MakeHeatMap(data=data,heatmap_directory = heatmap_directory,cluster_directory = cluster_directory,group_color_designations_file = group_color_designations_file,break_seq = seq(-2,2,0.5),ColGroupsScheme = c('Consensus Proteome','PAM50'),Scale_Rows = FALSE,TakeLog2 = TRUE,label_rows = FALSE,select_groups_to_keep = NULL)
data <- '/Users/Nate/Dropbox/Research/Lehtio_Laboratory/Projects/Breast_Cancer_Patient_Tumors/Metabolomics/Tumors with Proteome Quantification/metabolite_abundances_transposed.txt'
heatmap_directory <- '/Users/Nate/Dropbox/Research/Lehtio_Laboratory/Projects/Breast_Cancer_Patient_Tumors/Metabolomics/Tumors with Proteome Quantification/Test Plots/'
MakeHeatMap(data=data,heatmap_directory = heatmap_directory,cluster_directory = cluster_directory,group_color_designations_file = group_color_designations_file,break_seq = seq(-2,2,0.5),ColGroupsScheme = c('Consensus Proteome','PAM50'),Scale_Rows = 'median_center_iqr_norm',TakeLog2 = FALSE,label_rows = TRUE,select_groups_to_keep = NULL)
source('~/Dropbox/Research/Lehtio_Laboratory/Tools/R Functions/Heatmap Functions/MakeHeatmap.R')
MakeHeatMap(data=data,heatmap_directory = heatmap_directory,cluster_directory = cluster_directory,group_color_designations_file = group_color_designations_file,break_seq = seq(-2,2,0.5),ColGroupsScheme = c('Consensus Proteome','PAM50'),Scale_Rows = 'median_center_iqr_norm',TakeLog2 = FALSE,label_rows = TRUE,select_groups_to_keep = NULL)
rownames(DifExpMatx)
source('~/Dropbox/Research/Lehtio_Laboratory/Tools/R Functions/Heatmap Functions/MakeHeatmap.R')
source('~/Dropbox/Research/Lehtio_Laboratory/Tools/R Functions/Heatmap Functions/MakeHeatmap.R')
source('~/Dropbox/Research/Lehtio_Laboratory/Tools/R Functions/Heatmap Functions/MakeHeatmap.R')
MakeHeatMap(data=data,heatmap_directory = heatmap_directory,cluster_directory = cluster_directory,group_color_designations_file = group_color_designations_file,break_seq = seq(-2,2,0.5),ColGroupsScheme = c('Consensus Proteome','PAM50'),Scale_Rows = 'median_center_iqr_norm',TakeLog2 = FALSE,label_rows = TRUE,select_groups_to_keep = NULL)
source('~/Dropbox/Research/Lehtio_Laboratory/Tools/R Functions/Heatmap Functions/MakeHeatmap.R')
source('~/Dropbox/Research/Lehtio_Laboratory/Tools/R Functions/Heatmap Functions/MakeHeatmap.R')
MakeHeatMap(data=data,heatmap_directory = heatmap_directory,cluster_directory = cluster_directory,group_color_designations_file = group_color_designations_file,break_seq = seq(-2,2,0.5),ColGroupsScheme = c('Consensus Proteome','PAM50'),Scale_Rows = 'median_center_iqr_norm',TakeLog2 = FALSE,label_rows = TRUE,select_groups_to_keep = NULL)
MakeHeatMap(data=data,heatmap_directory = heatmap_directory,cluster_directory = cluster_directory,group_color_designations_file = group_color_designations_file,break_seq = seq(-2,2,0.5),ColGroupsScheme = c('Consensus Proteome','PAM50'),Scale_Rows = 'median_center_iqr_norm',TakeLog2 = FALSE,label_rows = TRUE,select_groups_to_keep = c('GRP1','GRP2','GRP3','GRP4','GRP5','GRP6'))
MakeHeatMap(data=data,heatmap_directory = heatmap_directory,cluster_directory = cluster_directory,group_color_designations_file = group_color_designations_file,break_seq = seq(-2,2,0.5),ColGroupsScheme = c('Consensus Proteome','PAM50'),Scale_Rows = 'median_center_iqr_norm',TakeLog2 = FALSE,label_rows = TRUE,select_groups_to_keep = c('GRP1','GRP2','GRP3','GRP4','GRP5','GRP6'))
MakeHeatMap(data=data,heatmap_directory = heatmap_directory,cluster_directory = cluster_directory,group_color_designations_file = group_color_designations_file,break_seq = seq(-2,2,0.5),ColGroupsScheme = c('Consensus Proteome','PAM50'),Scale_Rows = 'median_norm_log2_transform',TakeLog2 = FALSE,label_rows = TRUE,select_groups_to_keep = c('GRP1','GRP2','GRP3','GRP4','GRP5','GRP6'))
MakeHeatMap(data=data,heatmap_directory = heatmap_directory,cluster_directory = cluster_directory,group_color_designations_file = group_color_designations_file,break_seq = seq(-2,2,0.5),ColGroupsScheme = c('Consensus Proteome','PAM50'),Scale_Rows = 'median_center_iqr_norm',TakeLog2 = FALSE,label_rows = TRUE,select_groups_to_keep = c('GRP1','GRP2','GRP3','GRP4','GRP5','GRP6'))
MakeHeatMap(data=data,heatmap_directory = heatmap_directory,cluster_directory = cluster_directory,group_color_designations_file = group_color_designations_file,break_seq = seq(-2,2,0.5),ColGroupsScheme = c('Consensus Proteome','PAM50'),Scale_Rows = 'median_center_iqr_norm',TakeLog2 = FALSE,label_rows = TRUE,select_groups_to_keep = c('GRP1','GRP2','GRP3','GRP4','GRP5','GRP6'))
MakeHeatMap(data=data,heatmap_directory = heatmap_directory,cluster_directory = cluster_directory,group_color_designations_file = group_color_designations_file,break_seq = seq(-2,2,0.5),ColGroupsScheme = c('Consensus Proteome','PAM50'),Scale_Rows = 'median_center_iqr_norm',TakeLog2 = FALSE,label_rows = TRUE,select_groups_to_keep = c('GRP1','GRP2','GRP3','GRP4','GRP5','GRP6'),ClusterMethod = 'average')
MakeHeatMap(data=data,heatmap_directory = heatmap_directory,cluster_directory = cluster_directory,group_color_designations_file = group_color_designations_file,break_seq = seq(-2,2,0.5),ColGroupsScheme = c('Consensus Proteome','PAM50'),Scale_Rows = 'median_center_iqr_norm',TakeLog2 = FALSE,label_rows = TRUE,select_groups_to_keep = c('GRP1','GRP2','GRP3','GRP4','GRP5','GRP6'),ClusterMethod = 'complete')
MakeHeatMap(data=data,heatmap_directory = heatmap_directory,cluster_directory = cluster_directory,group_color_designations_file = group_color_designations_file,break_seq = seq(-2,2,0.5),ColGroupsScheme = c('Consensus Proteome','PAM50'),Scale_Rows = 'median_center_iqr_norm',TakeLog2 = FALSE,label_rows = TRUE,select_groups_to_keep = c('GRP1','GRP2','GRP3','GRP4','GRP5','GRP6'))
MakeHeatMap(data=data,heatmap_directory = heatmap_directory,cluster_directory = cluster_directory,group_color_designations_file = group_color_designations_file,break_seq = seq(-2,2,0.5),ColGroupsScheme = c('Consensus Proteome','PAM50'),Scale_Rows = 'median_center_iqr_norm',TakeLog2 = FALSE,label_rows = TRUE,select_groups_to_keep = NULL)
consensus_clusters <- c('GRP1','GRP2','GRP3','GRP4','GRP5','GRP6')
select_mets <- c('succinate','glutamine','alanine','lactate','glycine','acetate','scylloinositol','myoinositol')
MakeHeatMap(data=data,heatmap_directory = heatmap_directory,cluster_directory = cluster_directory,group_color_designations_file = group_color_designations_file,break_seq = seq(-2,2,0.5),ColGroupsScheme = c('Consensus Proteome','PAM50'),Scale_Rows = 'median_center_iqr_norm',TakeLog2 = FALSE,label_rows = TRUE,select_groups_to_keep = NULL,select_rows=select_mets)
source('~/Dropbox/Research/Lehtio_Laboratory/Tools/R Functions/Heatmap Functions/MakeHeatmap.R')
MakeHeatMap(data=data,heatmap_directory = heatmap_directory,cluster_directory = cluster_directory,group_color_designations_file = group_color_designations_file,break_seq = seq(-2,2,0.5),ColGroupsScheme = c('Consensus Proteome','PAM50'),Scale_Rows = 'median_center_iqr_norm',TakeLog2 = FALSE,label_rows = TRUE,select_groups_to_keep = consensus_clusters)
source('~/Dropbox/Research/Lehtio_Laboratory/Tools/R Functions/Heatmap Functions/MakeHeatmap.R')
MakeHeatMap(data=data,heatmap_directory = heatmap_directory,cluster_directory = cluster_directory,group_color_designations_file = group_color_designations_file,break_seq = seq(-2,2,0.5),ColGroupsScheme = c('Consensus Proteome','PAM50'),Scale_Rows = 'median_center_iqr_norm',TakeLog2 = FALSE,label_rows = TRUE,select_groups_to_keep = consensus_clusters)
source('~/Dropbox/Research/Lehtio_Laboratory/Tools/R Functions/Heatmap Functions/MakeHeatmap.R')
source('~/Dropbox/Research/Lehtio_Laboratory/Tools/R Functions/Heatmap Functions/GetGroupColorList.R')
rm(list = setdiff(ls(), lsf.str()))
source('~/Dropbox/Research/Lehtio_Laboratory/Tools/R Functions/Heatmap Functions/MakeHeatmap.R')
data <- '/Users/nate/Dropbox/Research/Lehtio_Laboratory/Projects/Breast_Cancer_Patient_Tumors/Proteome_Quantification_Data/Breast_Cancer_Cohort_Proteome.txt'
group_color_designations_file <- '/Users/nate/Dropbox/Research/Lehtio_Laboratory/Projects/Breast_Cancer_Patient_Tumors/Proteome_Quantification_Data/color_key_all.txt'
cluster_directory <- '/Users/nate/Dropbox/Research/Lehtio_Laboratory/Projects/Breast_Cancer_Patient_Tumors/Proteome_Quantification_Data/Proteome_All_Groupings.txt'
heatmap_directory <- '/Users/nate/Dropbox/Research/Lehtio_Laboratory/Projects/Breast_Cancer_Patient_Tumors/heatmaps_for_testing/'
group_color_designations_file
bct_heatmap <- MakeHeatMap(data=data,heatmap_directory=heatmap_directory,cluster_directory=cluster_directory,group_color_designations_file = group_color_designations_file,TakeLog2 = TRUE,break_seq=seq(-2,2,0.5),ColGroupsScheme = c('PAM50','Consensus Proteome'))
bct_heatmap <- MakeHeatMap(data=data,heatmap_directory=heatmap_directory,cluster_directory=cluster_directory,group_color_designations_file = group_color_designations_file,TakeLog2 = TRUE,break_seq=seq(-2,2,0.5),ColGroupsScheme = c('PAM50','Consensus Proteome'),label_rows = FALSE)
install.packages('ggplot2')
install.packages("ggplot2")
install.packages('heatmap.plus')
bct_heatmap <- MakeHeatMap(data=data,heatmap_directory=heatmap_directory,cluster_directory=cluster_directory,group_color_designations_file = group_color_designations_file,TakeLog2 = TRUE,break_seq=seq(-2,2,0.5),ColGroupsScheme = c('PAM50','Consensus Proteome'),label_rows = FALSE)
install.packages('gplots')
bct_heatmap <- MakeHeatMap(data=data,heatmap_directory=heatmap_directory,cluster_directory=cluster_directory,group_color_designations_file = group_color_designations_file,TakeLog2 = TRUE,break_seq=seq(-2,2,0.5),ColGroupsScheme = c('PAM50','Consensus Proteome'),label_rows = FALSE)
source('~/Dropbox/Research/Lehtio_Laboratory/Tools/R Functions/Heatmap Functions/GetGroupLegend.R')
bct_heatmap <- MakeHeatMap(data=data,heatmap_directory=heatmap_directory,cluster_directory=cluster_directory,group_color_designations_file = group_color_designations_file,TakeLog2 = TRUE,break_seq=seq(-2,2,0.5),ColGroupsScheme = c('PAM50','Consensus Proteome'),label_rows = FALSE)
source('~/Dropbox/Research/Lehtio_Laboratory/Tools/R Functions/Heatmap Functions/MakeHeatmap_dev.R')
transform
source('~/Dropbox/Research/Lehtio_Laboratory/Tools/R Functions/Heatmap Functions/transform_data.R')
bct_heatmap <- MakeHeatMap(data=data,heatmap_directory=heatmap_directory,cluster_directory=cluster_directory,group_color_designations_file = group_color_designations_file,transformation='log2',break_seq=seq(-2,2,0.5),ColGroupsScheme = c('PAM50','Consensus Proteome'),label_rows = FALSE)
source('~/Dropbox/Research/Lehtio_Laboratory/Tools/R Functions/Heatmap Functions/MakeHeatmap_dev.R')
bct_heatmap <- MakeHeatMap(data=data,heatmap_directory=heatmap_directory,cluster_directory=cluster_directory,group_color_designations_file = group_color_designations_file,transformation='log2',break_seq=seq(-2,2,0.5),ColGroupsScheme = c('PAM50','Consensus Proteome'),label_rows = FALSE)
source('~/Dropbox/Research/Lehtio_Laboratory/Tools/R Functions/Heatmap Functions/MakeHeatmap_dev.R')
bct_heatmap <- MakeHeatMap(data=data,heatmap_directory=heatmap_directory,cluster_directory=cluster_directory,group_color_designations_file = group_color_designations_file,transformation='log2',break_seq=seq(-2,2,0.5),ColGroupsScheme = c('PAM50','Consensus Proteome'),label_rows = FALSE)
class(DATA)
DATA <- transform_data(DATA,transformation)
source('~/Dropbox/Research/Lehtio_Laboratory/Tools/R Functions/Heatmap Functions/transform_data.R')
source('~/Dropbox/Research/Lehtio_Laboratory/Tools/R Functions/Heatmap Functions/MakeHeatmap_dev.R')
bct_heatmap <- MakeHeatMap(data=data,heatmap_directory=heatmap_directory,cluster_directory=cluster_directory,group_color_designations_file = group_color_designations_file,transformation='log2',break_seq=seq(-2,2,0.5),ColGroupsScheme = c('PAM50','Consensus Proteome'),label_rows = FALSE)
source('~/Dropbox/Research/Lehtio_Laboratory/Tools/R Functions/Heatmap Functions/MakeHeatmap_dev.R')
bct_heatmap <- MakeHeatMap(data=data,heatmap_directory=heatmap_directory,cluster_directory=cluster_directory,group_color_designations_file = group_color_designations_file,transformation='log2',break_seq=seq(-2,2,0.5),ColGroupsScheme = c('PAM50','Consensus Proteome'),label_rows = FALSE)
label(DATA)
source('~/Dropbox/Research/Lehtio_Laboratory/Tools/R Functions/Heatmap Functions/MakeHeatmap_dev.R')
mtcars
h <- median[mtcars[,c('mpg','cyl')]]
h <- median(mtcars[,c('mpg','cyl')])
h <- median(mtcars[,c('mpg','disp')])
class(mtcars$mpg)
class(mtcars$disp)
mtcars[, c("mpg", "cyl")]
mtcars[, c("mpg", "disp")]
v <- mtcars[, c("mpg", "disp")]
v
median(v)
sum(v)
apply(v,median)
apply(v,1,median)
v
v
h <- apply(v,1,mean)
h
class(h)
h[1]
k$mean <- h
k <- data.frame(h)
h
colnames(k) <- 'means'
k
h
colnames(h)
rownames(h)
names(h)
l <- as.matrix(h)
l
h
k
k[,'new'] <- h
k
mtcars[-'Volvo 142E',]
mtcars[-(rownamnes(mtcars)=='Volvo 142E',]
mtcars[-(rownamnes(mtcars)=='Volvo 142E'),]
mtcars[-(rownamne(mtcars)=='Volvo 142E'),]
mtcars[-(rowname(mtcars)=='Volvo 142E'),]
mtcars[-(rownames(mtcars)=='Volvo 142E'),]
mtcars['Volvo 142E',]
mtcars[-(rownames(mtcars)=='Volvo 142E'),]
mtcars[-(rownames(mtcars)=='Volvo 142E'
)]
mtcars[-(rownames(mtcars)=='Volvo 142E'
)
)
rownames(mtcars)=='Volvo 142E'
mtcars[!(rownames(mtcars)=='Volvo 142E',]
mtcars[!(rownames(mtcars)=='Volvo 142E'),]
source('~/.active-rstudio-document')
source('~/Dropbox/Research/Lehtio_Laboratory/Tools/R Functions/Heatmap Functions/StatTransformByGroup.R')
source('~/Dropbox/Research/Lehtio_Laboratory/Tools/R Functions/Heatmap Functions/StatTransformByGroup.R')
source('~/Dropbox/Research/Lehtio_Laboratory/Tools/R Functions/Heatmap Functions/MakeHeatmap_dev.R')
bct_heatmap <- MakeHeatMap(data=data,heatmap_directory=heatmap_directory,cluster_directory=cluster_directory,group_color_designations_file = group_color_designations_file,transformation='log2',break_seq=seq(-2,2,0.5),ColGroupsScheme = c('PAM50','Consensus Proteome'),label_rows = FALSE)
groups_corresponding_of_scheme <- groups_corresponding[grouping_scheme_transform,]
source('~/Dropbox/Research/Lehtio_Laboratory/Tools/R Functions/Heatmap Functions/StatTransformByGroup.R')
bct_heatmap <- MakeHeatMap(data=data,heatmap_directory=heatmap_directory,cluster_directory=cluster_directory,group_color_designations_file = group_color_designations_file,transformation='log2',break_seq=seq(-2,2,0.5),ColGroupsScheme = c('PAM50','Consensus Proteome'),label_rows = FALSE)
groups_corresponding_of_scheme <- groups_corresponding[grouping_scheme_transform,]
source('~/Dropbox/Research/Lehtio_Laboratory/Tools/R Functions/Heatmap Functions/MakeHeatmap_dev.R')
bct_heatmap <- MakeHeatMap(data=data,heatmap_directory=heatmap_directory,cluster_directory=cluster_directory,group_color_designations_file = group_color_designations_file,transformation='log2',break_seq=seq(-2,2,0.5),ColGroupsScheme = c('PAM50','Consensus Proteome'),label_rows = FALSE,grouping_scheme_transform = 'PAM50')
groups_corresponding_of_scheme <- groups_corresponding[grouping_scheme_transform,]
groups_corresponding_of_scheme
unique_groups <- unique(groups_corresponding[grouping_scheme,])
unique_groups
unique_groups <- unique(groups_corresponding[grouping_scheme,])
unique_groups <- unique(groups_corresponding[grouping_scheme_transform,])
unique_groups
n_unique_groups <- length(unique_groups)
samples <- colnames(groups_corresponding)
samples
GroupColorMatrix <- GroupColorMatrix[!rownames(GroupColorMatrix)==grouping_scheme,]
GroupColorMatrix <- GroupColorMatrix[!rownames(GroupColorMatrix)==grouping_scheme_transform,]
GroupColorMatrix
groups_corresponding <- groups_corresponding[!rownames(groups_corresponding)==grouping_scheme,]
groups_corresponding <- groups_corresponding[!rownames(groups_corresponding)==grouping_scheme_transform,]
groups_corresponding
DATA2 <- data.frame()
source('~/Dropbox/Research/Lehtio_Laboratory/Tools/R Functions/Heatmap Functions/StatTransformByGroup.R')
bct_heatmap <- MakeHeatMap(data=data,heatmap_directory=heatmap_directory,cluster_directory=cluster_directory,group_color_designations_file = group_color_designations_file,transformation='log2',break_seq=seq(-2,2,0.5),ColGroupsScheme = c('PAM50','Consensus Proteome'),label_rows = FALSE,grouping_scheme_transform = 'PAM50')
group <- unique_groups[i]
group
member_indices <- groups_corresponding_of_scheme[groups_corresponding_of_scheme==group]
member_indices
members <- samples[member_indices]
members
source('~/Dropbox/Research/Lehtio_Laboratory/Tools/R Functions/Heatmap Functions/StatTransformByGroup.R')
bct_heatmap <- MakeHeatMap(data=data,heatmap_directory=heatmap_directory,cluster_directory=cluster_directory,group_color_designations_file = group_color_designations_file,transformation='log2',break_seq=seq(-2,2,0.5),ColGroupsScheme = c('PAM50','Consensus Proteome'),label_rows = FALSE,grouping_scheme_transform = 'PAM50')
group <- unique_groups[i]
member_indices <- groups_corresponding_of_scheme[groups_corresponding_of_scheme==group]
members <- samples[member_indices]
members
samples
samples
member_indices
source('~/Dropbox/Research/Lehtio_Laboratory/Tools/R Functions/Heatmap Functions/StatTransformByGroup.R')
bct_heatmap <- MakeHeatMap(data=data,heatmap_directory=heatmap_directory,cluster_directory=cluster_directory,group_color_designations_file = group_color_designations_file,transformation='log2',break_seq=seq(-2,2,0.5),ColGroupsScheme = c('PAM50','Consensus Proteome'),label_rows = FALSE,grouping_scheme_transform = 'PAM50')
browser()
group <- unique_groups[i]
member_indices <- groups_corresponding_of_scheme==group
members <- samples[member_indices]
members
colnames(groups_corresponding)
median_vector <- apply(DATA[members,],1,median)
median_vector[1:5]
median_vector <- apply(DATA[,members],1,median)
median_vector[1:5]
DATA2[,group] <- median_vector
DATA2 <- data.frame(matrix(ncol=0,nrow=nrow(DATA)))
DATA2[,group] <- median_vector
DATA2[1:5,'basal']
rownames(DATA2)
rownames(DATA2) <- rownames(DATA)
DATA2[,group] <- median_vector
DATA2[1:5,group]
rownames(DATA2)
DATA2$basal[1:5]
source('~/Dropbox/Research/Lehtio_Laboratory/Tools/R Functions/Heatmap Functions/StatTransformByGroup.R')
bct_heatmap <- MakeHeatMap(data=data,heatmap_directory=heatmap_directory,cluster_directory=cluster_directory,group_color_designations_file = group_color_designations_file,transformation='log2',break_seq=seq(-2,2,0.5),ColGroupsScheme = c('PAM50','Consensus Proteome'),label_rows = FALSE,grouping_scheme_transform = 'PAM50')
DATA2[1:5,1:5]
source('~/Dropbox/Research/Lehtio_Laboratory/Tools/R Functions/Heatmap Functions/StatTransformByGroup.R')
bct_heatmap <- MakeHeatMap(data=data,heatmap_directory=heatmap_directory,cluster_directory=cluster_directory,group_color_designations_file = group_color_designations_file,transformation='log2',break_seq=seq(-2,2,0.5),ColGroupsScheme = c('PAM50','Consensus Proteome'),label_rows = FALSE,grouping_scheme_transform = 'PAM50')
source('~/Dropbox/Research/Lehtio_Laboratory/Tools/R Functions/Heatmap Functions/StatTransformByGroup.R')
bct_heatmap <- MakeHeatMap(data=data,heatmap_directory=heatmap_directory,cluster_directory=cluster_directory,group_color_designations_file = group_color_designations_file,transformation='log2',break_seq=seq(-2,2,0.5),ColGroupsScheme = c('PAM50','Consensus Proteome'),label_rows = FALSE,grouping_scheme_transform = 'PAM50')
n_grouping_schemes
source('~/Dropbox/Research/Lehtio_Laboratory/Tools/R Functions/Heatmap Functions/StatTransformByGroup.R')
source('~/Dropbox/Research/Lehtio_Laboratory/Tools/R Functions/Heatmap Functions/StatTransformByGroup.R')
bct_heatmap <- MakeHeatMap(data=data,heatmap_directory=heatmap_directory,cluster_directory=cluster_directory,group_color_designations_file = group_color_designations_file,transformation='log2',break_seq=seq(-2,2,0.5),ColGroupsScheme = c('PAM50','Consensus Proteome'),label_rows = FALSE,grouping_scheme_transform = 'PAM50')
Color_DF <- data.frame(matrix(nrow=n_grouping_schemes,ncol=n_unique_groups))
Groupings_DF <- data.frame(matrix(nrow=n_grouping_schemes,ncol=n_unique_groups))
source('~/Dropbox/Research/Lehtio_Laboratory/Tools/R Functions/Heatmap Functions/StatTransformByGroup.R')
bct_heatmap <- MakeHeatMap(data=data,heatmap_directory=heatmap_directory,cluster_directory=cluster_directory,group_color_designations_file = group_color_designations_file,transformation='log2',break_seq=seq(-2,2,0.5),ColGroupsScheme = c('PAM50','Consensus Proteome'),label_rows = FALSE,grouping_scheme_transform = 'PAM50')
member_indices
which(member_indices)
class(GroupColorMatrix)
source('~/Dropbox/Research/Lehtio_Laboratory/Tools/R Functions/Heatmap Functions/StatTransformByGroup.R')
bct_heatmap <- MakeHeatMap(data=data,heatmap_directory=heatmap_directory,cluster_directory=cluster_directory,group_color_designations_file = group_color_designations_file,transformation='log2',break_seq=seq(-2,2,0.5),ColGroupsScheme = c('PAM50','Consensus Proteome'),label_rows = FALSE,grouping_scheme_transform = 'PAM50')
class(GroupColorMatrix)
nrow(GroupColorMatrix)
source('~/Dropbox/Research/Lehtio_Laboratory/Tools/R Functions/Heatmap Functions/StatTransformByGroup.R')
source('~/Dropbox/Research/Lehtio_Laboratory/Tools/R Functions/Heatmap Functions/StatTransformByGroup.R')
bct_heatmap <- MakeHeatMap(data=data,heatmap_directory=heatmap_directory,cluster_directory=cluster_directory,group_color_designations_file = group_color_designations_file,transformation='log2',break_seq=seq(-2,2,0.5),ColGroupsScheme = c('PAM50','Consensus Proteome'),label_rows = FALSE,grouping_scheme_transform = 'PAM50')
nrow(GroupColorMatrix)
source('~/Dropbox/Research/Lehtio_Laboratory/Tools/R Functions/Heatmap Functions/StatTransformByGroup.R')
bct_heatmap <- MakeHeatMap(data=data,heatmap_directory=heatmap_directory,cluster_directory=cluster_directory,group_color_designations_file = group_color_designations_file,transformation='log2',break_seq=seq(-2,2,0.5),ColGroupsScheme = c('PAM50','Consensus Proteome'),label_rows = FALSE,grouping_scheme_transform = 'PAM50')
source('~/Dropbox/Research/Lehtio_Laboratory/Tools/R Functions/Heatmap Functions/StatTransformByGroup.R')
bct_heatmap <- MakeHeatMap(data=data,heatmap_directory=heatmap_directory,cluster_directory=cluster_directory,group_color_designations_file = group_color_designations_file,transformation='log2',break_seq=seq(-2,2,0.5),ColGroupsScheme = c('PAM50','Consensus Proteome'),label_rows = FALSE,grouping_scheme_transform = 'PAM50')
Color_DF
source('~/Dropbox/Research/Lehtio_Laboratory/Tools/R Functions/Heatmap Functions/StatTransformByGroup.R')
bct_heatmap <- MakeHeatMap(data=data,heatmap_directory=heatmap_directory,cluster_directory=cluster_directory,group_color_designations_file = group_color_designations_file,transformation='log2',break_seq=seq(-2,2,0.5),ColGroupsScheme = c('PAM50','Consensus Proteome'),label_rows = FALSE,grouping_scheme_transform = 'PAM50')
Color_DF
GroupColorMatrix
group_color_column
GroupColorMatrix[,group_color_column]
source('~/Dropbox/Research/Lehtio_Laboratory/Tools/R Functions/Heatmap Functions/StatTransformByGroup.R')
bct_heatmap <- MakeHeatMap(data=data,heatmap_directory=heatmap_directory,cluster_directory=cluster_directory,group_color_designations_file = group_color_designations_file,transformation='log2',break_seq=seq(-2,2,0.5),ColGroupsScheme = c('PAM50','Consensus Proteome'),label_rows = FALSE,grouping_scheme_transform = 'PAM50')
Color_DF
source('~/Dropbox/Research/Lehtio_Laboratory/Tools/R Functions/Heatmap Functions/StatTransformByGroup.R')
bct_heatmap <- MakeHeatMap(data=data,heatmap_directory=heatmap_directory,cluster_directory=cluster_directory,group_color_designations_file = group_color_designations_file,transformation='log2',break_seq=seq(-2,2,0.5),ColGroupsScheme = c('PAM50','Consensus Proteome'),label_rows = FALSE,grouping_scheme_transform = 'PAM50')
Color_DF
source('~/Dropbox/Research/Lehtio_Laboratory/Tools/R Functions/Heatmap Functions/StatTransformByGroup.R')
bct_heatmap <- MakeHeatMap(data=data,heatmap_directory=heatmap_directory,cluster_directory=cluster_directory,group_color_designations_file = group_color_designations_file,transformation='log2',break_seq=seq(-2,2,0.5),ColGroupsScheme = c('PAM50','Consensus Proteome'),label_rows = FALSE,grouping_scheme_transform = 'PAM50')
groups_corresponding
GroupColorMatrix
source('~/Dropbox/Research/Lehtio_Laboratory/Tools/R Functions/Heatmap Functions/StatTransformByGroup.R')
bct_heatmap <- MakeHeatMap(data=data,heatmap_directory=heatmap_directory,cluster_directory=cluster_directory,group_color_designations_file = group_color_designations_file,transformation='log2',break_seq=seq(-2,2,0.5),ColGroupsScheme = c('PAM50','Consensus Proteome'),label_rows = FALSE,grouping_scheme_transform = 'PAM50')
Color_DF
Groupings_DF
Groupings_DF
Groupings_DF
Color_DF
source('~/Dropbox/Research/Lehtio_Laboratory/Tools/R Functions/Heatmap Functions/StatTransformByGroup.R')
source('~/Dropbox/Research/Lehtio_Laboratory/Tools/R Functions/Heatmap Functions/StatTransformByGroup.R')
source('~/Dropbox/Research/Lehtio_Laboratory/Tools/R Functions/Heatmap Functions/MakeHeatmap_dev.R')
bct_heatmap <- MakeHeatMap(data=data,heatmap_directory=heatmap_directory,cluster_directory=cluster_directory,group_color_designations_file = group_color_designations_file,transformation='log2',break_seq=seq(-2,2,0.5),ColGroupsScheme = c('PAM50','Consensus Proteome'),label_rows = FALSE,grouping_scheme_transform = 'PAM50')
source('~/Dropbox/Research/Lehtio_Laboratory/Tools/R Functions/Heatmap Functions/MakeHeatmap_dev.R')
bct_heatmap <- MakeHeatMap(data=data,heatmap_directory=heatmap_directory,cluster_directory=cluster_directory,group_color_designations_file = group_color_designations_file,transformation='log2',break_seq=seq(-2,2,0.5),ColGroupsScheme = c('PAM50','Consensus Proteome'),label_rows = FALSE,grouping_scheme_transform = 'PAM50')
GroupColorMatrix
DATA[1:5,]
DATA <- transform_data(DATA,transformation)
if (DistanceMethod == 'pearson' || DistanceMethod == 'spearman')
{
Cor_col <- cor(DATA,method=DistanceMethod) #transpose oppsitely as when using dist() function?
D_col <- (1-Cor_col)/2 #this is actually dissimilarity, zero is least dissimilar (correlation of 1) and 1 is most dissimilar (correlation of -1)
D_col <- as.dist(D_col) #make a distance object so it can be input into hclust, clustering is performed on dissimilarity
Cor_row <- cor(t(DATA),method=DistanceMethod)
D_row <- (1-Cor_row)/2
D_row <- as.dist(D_row)
}
bct_heatmap <- MakeHeatMap(data=data,heatmap_directory=heatmap_directory,cluster_directory=cluster_directory,group_color_designations_file = group_color_designations_file,transformation='log2',break_seq=seq(-2,2,0.5),ColGroupsScheme = c('PAM50','Consensus Proteome'),label_rows = FALSE,grouping_scheme_transform = 'PAM50')
DATA <- transform_data(DATA,transformation)
Cor_col <- cor(DATA,method=DistanceMethod) #transpose oppsitely as when using dist() function?
D_col <- (1-Cor_col)/2 #this is actually dissimilarity, zero is least dissimilar (correlation of 1) and 1 is most dissimilar (correlation of -1)
D_col <- as.dist(D_col) #make a distance object so it can be input into hclust, clustering is performed on dissimilarity
Cor_row <- cor(t(DATA),method=DistanceMethod)
D_row <- (1-Cor_row)/2
D_row <- as.dist(D_row)
C_col <- hclust(D_col, method=ClusterMethod,members=NULL)
C_row <- hclust(D_row, method=ClusterMethod,members=NULL)
Cor_row <- cor(t(DATA),method=DistanceMethod)
DATA[1:5,]
h <- cor(DATA,method='pearson')
h
Cor_row <- cor(t(DATA),method=DistanceMethod)
Cor_row[1:5,1:5]
D_row <- (1-Cor_row)/2
D_row <- as.dist(D_row)
C_col <- hclust(D_col, method=ClusterMethod,members=NULL)
C_row <- hclust(D_row, method=ClusterMethod,members=NULL)
D_col
class(D_col)
var(c(1,2,3))
var(c(1,2,3,2,1,3))
source('~/Dropbox/Research/Lehtio_Laboratory/Tools/R Functions/Heatmap Functions/remove_zero_var_rows.R')
bct_heatmap <- MakeHeatMap(data=data,heatmap_directory=heatmap_directory,cluster_directory=cluster_directory,group_color_designations_file = group_color_designations_file,transformation='log2',break_seq=seq(-2,2,0.5),ColGroupsScheme = c('PAM50','Consensus Proteome'),label_rows = FALSE,grouping_scheme_transform = 'PAM50')
source('~/Dropbox/Research/Lehtio_Laboratory/Tools/R Functions/Heatmap Functions/MakeHeatmap_dev.R')
source('~/Dropbox/Research/Lehtio_Laboratory/Tools/R Functions/Heatmap Functions/MakeHeatmap_dev.R')
bct_heatmap <- MakeHeatMap(data=data,heatmap_directory=heatmap_directory,cluster_directory=cluster_directory,group_color_designations_file = group_color_designations_file,transformation='log2',break_seq=seq(-2,2,0.5),ColGroupsScheme = c('PAM50','Consensus Proteome'),label_rows = FALSE,grouping_scheme_transform = 'PAM50')
DATA <- transform_data(DATA,transformation)
DATA <- remove_zero_var_rows(DATA)
dim(DATA)
Cor_col <- cor(DATA,method=DistanceMethod) #transpose oppsitely as when using dist() function?
D_col <- (1-Cor_col)/2 #this is actually dissimilarity, zero is least dissimilar (correlation of 1) and 1 is most dissimilar (correlation of -1)
D_col <- as.dist(D_col) #make a distance object so it can be input into hclust, clustering is performed on dissimilarity
Cor_row <- cor(t(DATA),method=DistanceMethod)
D_row <- (1-Cor_row)/2
D_row <- as.dist(D_row)
bct_heatmap <- MakeHeatMap(data=data,heatmap_directory=heatmap_directory,cluster_directory=cluster_directory,group_color_designations_file = group_color_designations_file,transformation='log2',break_seq=seq(-2,2,0.5),ColGroupsScheme = c('PAM50','Consensus Proteome'),label_rows = FALSE,grouping_scheme_transform = 'PAM50')
DATA <- transform_data(DATA,transformation)
DATA <- remove_zero_var_rows(DATA)
DATA[1:5,1:5]
max(DATA$her2)
Cor_col <- cor(DATA,method=DistanceMethod) #transpose oppsitely as when using dist() function?
D_col <- (1-Cor_col)/2 #this is actually dissimilarity, zero is least dissimilar (correlation of 1) and 1 is most dissimilar (correlation of -1)
D_col <- as.dist(D_col) #make a distance object so it can be input into hclust, clustering is performed on dissimilarity
Cor_row <- cor(t(DATA),method=DistanceMethod)
D_row <- (1-Cor_row)/2
D_row <- as.dist(D_row)
C_col <- hclust(D_col, method=ClusterMethod,members=NULL)
C_row <- hclust(D_row, method=ClusterMethod,members=NULL)
colv <- as.dendrogram(C_col)
rowv <- as.dendrogram(C_row)
DifExpMatx=matrix(as.numeric(unlist(DATA)),nrow=nrow(DATA))
rownames(DifExpMatx)<-rownames(DATA) #name the rows of the numeric matrix so they are transfered to the dendrogram in the heat map
colnames(DifExpMatx)<-colnames(DATA) #name the columns of the numeric matrix so they are transfered to the dendrogram in the heat map
GroupColorMatrix <- t(GroupColorMatrix)
GroupColorMatrix <- cbind(GroupColorMatrix,GroupColorMatrix)
n_colors = length(break_seq)-1
source('~/Dropbox/Research/Lehtio_Laboratory/Tools/R Functions/Heatmap Functions/MakeHeatmap_dev.R')
bct_heatmap <- MakeHeatMap(data=data,heatmap_directory=heatmap_directory,cluster_directory=cluster_directory,group_color_designations_file = group_color_designations_file,transformation='log2',break_seq=seq(-2,2,0.5),ColGroupsScheme = c('PAM50','Consensus Proteome'),label_rows = FALSE,grouping_scheme_transform = 'PAM50')
n_colors = length(break_seq)-1
break_seq_0 <- break_seq #save the originally specified break_seq to use in the color key creation
source('~/Dropbox/Research/Lehtio_Laboratory/Tools/R Functions/Heatmap Functions/MakeHeatmap_dev.R')
bct_heatmap <- MakeHeatMap(data=data,heatmap_directory=heatmap_directory,cluster_directory=cluster_directory,group_color_designations_file = group_color_designations_file,transformation='log2',break_seq=seq(-2,2,0.5),ColGroupsScheme = c('PAM50','Consensus Proteome'),label_rows = FALSE,grouping_scheme_transform = 'PAM50')
heat_map_colors <- colorRampPalette(c('blue','white','red'))(n_colors)
HeatmapName <- paste('heatmap',DistanceMethod,paste(ClusterMethod,'.pdf',sep=''),sep='_')
PDF_file <- paste(HeatmapDirectory,HeatmapName,sep='')
PdfW = 7
PdfH = 7
pdf(PDF_file,height=PdfH,width=PdfW) #not sure of the units of width and height
heatmap <- heatmap.plus(x=DifExpMatx,
Colv=colv,
Rowv=rowv,
cexRow=1,
cexCol=0.5,
ColSideColors = GroupColorMatrix,
col=heat_map_colors,
breaks=break_seq,
margins=c(5,10),
scale='none', #This has to be specified in heatmap.plus and heatmap but not in heatmap.2
labRow=label_rows
)
dev.off()
MakeColorKey(break_seq_0,heat_map_colors,heatmap_directory)
MakeGroupLegend(groups_corresponding,t(GroupColorMatrix),ColGroupsScheme,heatmap_directory)
return(list(C_col,C_row,groups_corresponding,DATA))
source('~/Dropbox/Research/Lehtio_Laboratory/Tools/R Functions/Heatmap Functions/MakeHeatmap_dev.R')
bct_heatmap <- MakeHeatMap(data=data,heatmap_directory=heatmap_directory,cluster_directory=cluster_directory,group_color_designations_file = group_color_designations_file,transformation='log2',break_seq=seq(-2,2,0.5),ColGroupsScheme = c('PAM50','Consensus Proteome'),label_rows = FALSE,grouping_scheme_transform = 'PAM50')
source('~/Dropbox/Research/Lehtio_Laboratory/Tools/R Functions/Heatmap Functions/MakeHeatmap_dev.R')
bct_heatmap <- MakeHeatMap(data=data,heatmap_directory=heatmap_directory,cluster_directory=cluster_directory,group_color_designations_file = group_color_designations_file,transformation='log2',break_seq=seq(-2,2,0.5),ColGroupsScheme = c('PAM50','Consensus Proteome'),label_rows = FALSE,grouping_scheme_transform = 'PAM50')
class(GroupColorMatrix)
source('~/Dropbox/Research/Lehtio_Laboratory/Tools/R Functions/Heatmap Functions/MakeHeatmap_dev.R')
source('~/Dropbox/Research/Lehtio_Laboratory/Tools/R Functions/Heatmap Functions/MakeHeatmap_dev.R')
source('~/Dropbox/Research/Lehtio_Laboratory/Tools/R Functions/Heatmap Functions/assemble_heatmap.R')
source('~/Dropbox/Research/Lehtio_Laboratory/Tools/R Functions/Heatmap Functions/MakeHeatmap_dev.R')
bct_heatmap <- MakeHeatMap(data=data,heatmap_directory=heatmap_directory,cluster_directory=cluster_directory,group_color_designations_file = group_color_designations_file,transformation='log2',break_seq=seq(-2,2,0.5),ColGroupsScheme = c('PAM50','Consensus Proteome'),label_rows = FALSE,grouping_scheme_transform = 'PAM50')
source('~/Dropbox/Research/Lehtio_Laboratory/Tools/R Functions/Heatmap Functions/MakeHeatmap_dev.R')
source('~/Dropbox/Research/Lehtio_Laboratory/Tools/R Functions/Heatmap Functions/assemble_heatmap.R')
bct_heatmap <- MakeHeatMap(data=data,heatmap_directory=heatmap_directory,cluster_directory=cluster_directory,group_color_designations_file = group_color_designations_file,transformation='log2',break_seq=seq(-2,2,0.5),ColGroupsScheme = c('PAM50','Consensus Proteome'),label_rows = FALSE,grouping_scheme_transform = 'PAM50')
source('~/Dropbox/Research/Lehtio_Laboratory/Tools/R Functions/Heatmap Functions/MakeHeatmap_dev.R')
bct_heatmap <- MakeHeatMap(data=data,heatmap_directory=heatmap_directory,cluster_directory=cluster_directory,group_color_designations_file = group_color_designations_file,transformation='log2',break_seq=seq(-2,2,0.5),ColGroupsScheme = c('PAM50','Consensus Proteome'),label_rows = FALSE,grouping_scheme_transform = 'PAM50')
source('~/Dropbox/Research/Lehtio_Laboratory/Tools/R Functions/Heatmap Functions/MakeHeatmap_dev.R')
source('~/Dropbox/Research/Lehtio_Laboratory/Tools/R Functions/Heatmap Functions/assemble_heatmap.R')
bct_heatmap <- MakeHeatMap(data=data,heatmap_directory=heatmap_directory,cluster_directory=cluster_directory,group_color_designations_file = group_color_designations_file,transformation='log2',break_seq=seq(-2,2,0.5),ColGroupsScheme = c('PAM50','Consensus Proteome'),label_rows = FALSE,grouping_scheme_transform = 'PAM50')
source('~/Dropbox/Research/Lehtio_Laboratory/Tools/R Functions/Heatmap Functions/StatTransformByGroup.R')
source('~/Dropbox/Research/Lehtio_Laboratory/Tools/R Functions/Heatmap Functions/MakeHeatmap_dev.R')
bct_heatmap <- MakeHeatMap(data=data,heatmap_directory=heatmap_directory,cluster_directory=cluster_directory,group_color_designations_file = group_color_designations_file,transformation='log2',break_seq=seq(-2,2,0.5),ColGroupsScheme = c('PAM50','Consensus Proteome'),label_rows = FALSE,grouping_scheme_transform = 'PAM50')
bct_heatmap <- MakeHeatMap(data=data,heatmap_directory=heatmap_directory,cluster_directory=cluster_directory,group_color_designations_file = group_color_designations_file,transformation='log2',break_seq=seq(-2,2,0.5),ColGroupsScheme = c('PAM50','Consensus Proteome'),label_rows = FALSE,replicate_scheme  = 'PAM50')
source('~/Dropbox/Research/Lehtio_Laboratory/Tools/R Functions/Heatmap Functions/MakeHeatmap_dev.R')
bct_heatmap <- MakeHeatMap(data=data,heatmap_directory=heatmap_directory,cluster_directory=cluster_directory,group_color_designations_file = group_color_designations_file,transformation='log2',break_seq=seq(-2,2,0.5),ColGroupsScheme = c('PAM50','Consensus Proteome'),label_rows = FALSE,replicate_scheme  = 'PAM50')
source('~/Dropbox/Research/Lehtio_Laboratory/Tools/R Functions/Heatmap Functions/MakeHeatmap_dev.R')
source('~/Dropbox/Research/Lehtio_Laboratory/Tools/R Functions/Heatmap Functions/MakeHeatmap_dev.R')
bct_heatmap <- MakeHeatMap(data=data,heatmap_directory=heatmap_directory,cluster_directory=cluster_directory,group_color_designations_file = group_color_designations_file,transformation='log2',break_seq=seq(-2,2,0.5),ColGroupsScheme = c('PAM50','Consensus Proteome'),label_rows = FALSE,replicate_scheme  = 'PAM50')
source('~/Dropbox/Research/Lehtio_Laboratory/Tools/R Functions/Heatmap Functions/MakeHeatmap_dev.R')
source('~/Dropbox/Research/Lehtio_Laboratory/Tools/R Functions/Heatmap Functions/GetGroupColorList.R')
source('~/Dropbox/Research/Lehtio_Laboratory/Tools/R Functions/Heatmap Functions/MakeHeatmap_dev.R')
bct_heatmap <- MakeHeatMap(data=data,heatmap_directory=heatmap_directory,cluster_directory=cluster_directory,group_color_designations_file = group_color_designations_file,transformation='log2',break_seq=seq(-2,2,0.5),ColGroupsScheme = c('PAM50','Consensus Proteome'),label_rows = FALSE,replicate_scheme  = 'PAM50')
source('~/Dropbox/Research/Lehtio_Laboratory/Tools/R Functions/Heatmap Functions/MakeHeatmap_dev.R')
source('~/Dropbox/Research/Lehtio_Laboratory/Tools/R Functions/Heatmap Functions/MakeHeatmap_dev.R')
bct_heatmap <- MakeHeatMap(data=data,heatmap_directory=heatmap_directory,cluster_directory=cluster_directory,group_color_designations_file = group_color_designations_file,transformation='log2',break_seq=seq(-2,2,0.5),ColGroupsScheme = c('PAM50','Consensus Proteome'),label_rows = FALSE,replicate_scheme  = 'PAM50')
source('~/Dropbox/Research/Lehtio_Laboratory/Tools/R Functions/Heatmap Functions/MakeHeatmap.R')
source('~/Dropbox/Research/Lehtio_Laboratory/Tools/R Functions/Heatmap Functions/transform_data.R')
rm(list = setdiff(ls(), lsf.str()))
View(Center_Scale)
View(MakeColorKey)
View(GetGroupColorList)
View(Center_Scale)
View(MakeGroupLegend)
View(MakeColorKey)
View(GetGroupColorList)
View(Center_Scale)
rm(Center_Scale())
rm(Center_Scale)
rm(GetGroupColorList)
rm(MakeColorKey())
rm(MakeColorKey)
rm(MakeGroupLegend)
rm(MakeHeatMap)
rm(MapToColors)
rm(median_center_iqr_norm)
rm(median_norm_log2_transform)
rm(transform_data)
getwd
getwd()
HeatmapDirectory <- paste(working_directory,'/output/')
working_directory <- getwd()
HeatmapDirectory <- paste(working_directory,'/output/')
dir.create(HeatmapDirectory)
HeatmapDirectory <- paste(working_directory,'/output/',sep='')
dir.create(HeatmapDirectory)
dir.create(HeatmapDirectory)
source('~/Dropbox/Research/Lehtio_Laboratory/Tools/R Functions/Heatmap Functions/MakeHeatmap.R')
source('~/Dropbox/Research/Lehtio_Laboratory/Tools/R Functions/Heatmap Functions/MakeHeatmap.R')
source('~/Dropbox/Research/Lehtio_Laboratory/Tools/R Functions/Heatmap Functions/MakeHeatmap.R')
source('~/Dropbox/Research/Lehtio_Laboratory/Tools/R Functions/Heatmap Functions/assemble_heatmap.R')
source('~/Dropbox/Research/Lehtio_Laboratory/Tools/R Functions/Heatmap Functions/GetGroupColorList.R')
source('~/Dropbox/Research/Lehtio_Laboratory/Tools/R Functions/Heatmap Functions/GetGroupLegend.R')
source('~/Dropbox/Research/Lehtio_Laboratory/Tools/R Functions/Heatmap Functions/MakeColorKey.R')
source('~/Dropbox/Research/Lehtio_Laboratory/Tools/R Functions/Heatmap Functions/remove_zero_var_rows.R')
source('~/Dropbox/Research/Lehtio_Laboratory/Tools/R Functions/Heatmap Functions/StatTransformByGroup.R')
source('~/Dropbox/Research/Lehtio_Laboratory/Tools/R Functions/Heatmap Functions/transform_data.R')
data_location <- '/Users/nate/Dropbox/Research/Lehtio_Laboratory/Projects/Breast_Cancer_Patient_Tumors/Metabolomics/Tumors with Proteome Quantification/'
ColGroupsScheme <- c('PAM50','Consensus Proteome')
transformation <- 'median_center_iqr_norm'
break_seq <- c(-2,2,0.5)
MakeHeatMap(data_location,ColGroupsScheme,transformation,break_seq)
source('~/Dropbox/Research/Lehtio_Laboratory/Tools/R Functions/Heatmap Functions/MakeHeatmap.R')
MakeHeatMap(data_location,ColGroupsScheme,transformation,break_seq)
break_seq
break_seq <- seq(-2,2,0.5)
break_seq
MakeHeatMap(data_location,ColGroupsScheme,transformation,break_seq)
source('~/Dropbox/Research/Lehtio_Laboratory/Tools/R Functions/Heatmap Functions/MakeHeatmap.R')
MakeHeatMap(data_location,ColGroupsScheme,transformation,break_seq)
ColGroupsScheme <- c('Consensus Proteome','PAM50')
MakeHeatMap(data_location,ColGroupsScheme,transformation,break_seq)
select_groups_to_keep <- c('GRP1','GRP2','GRP3','GRP4','GRP5','GRP6')
MakeHeatMap(data_location,ColGroupsScheme,transformation,break_seq,select_groups_to_keep=select_groups_to_keep)
select_rows <- c('succinate','glutamine','alanine','lactate','glycine','acetate','scylloinositol','myoinositol')
MakeHeatMap(data_location,ColGroupsScheme,transformation,break_seq,select_groups_to_keep=select_groups_to_keep,select_rows=select_rows)
rm(list = setdiff(ls(), lsf.str()))
data_location <- '/Users/nate/Dropbox/Research/Lehtio_Laboratory/Projects/Breast_Cancer_Patient_Tumors/Metabolomics/Tumors with Proteome Quantification/'
ColGroupsScheme <- c('Consensus Proteome','PAM50')
transformation <- 'median_center_iqr_norm'
break_seq <- seq(-2,2,0.5)
select_groups_to_keep <- c('GRP1','GRP2','GRP3','GRP4','GRP5','GRP6')
select_rows <- c('succinate','glutamine','alanine','lactate','glycine','acetate','scylloinositol','myoinositol')
MakeHeatMap(data_location,ColGroupsScheme,transformation,break_seq,select_groups_to_keep=select_groups_to_keep,select_rows=select_rows)
data_location
source('~/Dropbox/Research/Lehtio_Laboratory/Tools/R Functions/Heatmap Functions/MakeHeatmap.R')
MakeHeatMap(data_location,ColGroupsScheme,transformation,break_seq,select_groups_to_keep=select_groups_to_keep,select_rows=select_rows)
source('~/Dropbox/Research/Lehtio_Laboratory/Tools/R Functions/Heatmap Functions/assemble_heatmap.R')
source('~/Dropbox/Research/Lehtio_Laboratory/Tools/R Functions/Heatmap Functions/GetGroupColorList.R')
source('~/Dropbox/Research/Lehtio_Laboratory/Tools/R Functions/Heatmap Functions/GetGroupLegend.R')
source('~/Dropbox/Research/Lehtio_Laboratory/Tools/R Functions/Heatmap Functions/MakeColorKey.R')
source('~/Dropbox/Research/Lehtio_Laboratory/Tools/R Functions/Heatmap Functions/remove_zero_var_rows.R')
source('~/Dropbox/Research/Lehtio_Laboratory/Tools/R Functions/Heatmap Functions/transform_data.R')
source('~/Dropbox/Research/Lehtio_Laboratory/Tools/R Functions/Heatmap Functions/StatTransformByGroup.R')
source('~/Dropbox/Research/Lehtio_Laboratory/Tools/R Functions/Heatmap Functions/remove_zero_var_rows.R')
source('~/Dropbox/Research/Lehtio_Laboratory/Tools/R Functions/Heatmap Functions/MakeColorKey.R')
source('~/Dropbox/Research/Lehtio_Laboratory/Tools/R Functions/Heatmap Functions/GetGroupLegend.R')
source('~/Dropbox/Research/Lehtio_Laboratory/Tools/R Functions/Heatmap Functions/GetGroupColorList.R')
source('~/Dropbox/Research/Lehtio_Laboratory/Tools/R Functions/Heatmap Functions/assemble_heatmap.R')
source('~/Dropbox/Research/Lehtio_Laboratory/Tools/R Functions/Heatmap Functions/MakeHeatmap.R')
MakeHeatMap(data_location,ColGroupsScheme,transformation,break_seq,select_groups_to_keep=select_groups_to_keep,select_rows=select_rows)
MakeHeatMap(data_location,ColGroupsScheme,transformation,break_seq,select_groups_to_keep=select_groups_to_keep,select_rows=NULL)
MakeHeatMap(data_location,ColGroupsScheme,transformation,break_seq,select_groups_to_keep=NULL,select_rows=select_rows)
MakeHeatMap(data_location,ColGroupsScheme,transformation,break_seq,select_groups_to_keep=select_groups_to_keep,select_rows=select_rows)
MakeHeatMap(data_location,ColGroupsScheme,transformation,break_seq,select_groups_to_keep=select_groups_to_keep,select_rows=select_rows,ClusterMethod='average')
